!function(e){function t(t,n){var i=this,t=e(t),s=e('<div class="fg-menu-container ui-widget ui-widget-content ui-corner-all">'+n.content+"</div>");this.menuOpen=!1,this.menuExists=!1;var n=jQuery.extend({content:null,width:220,maxHeight:180,positionOpts:{posX:"left",posY:"bottom",offsetX:0,offsetY:0,directionH:"right",directionV:"down",detectH:!0,detectV:!0,linkToFront:!1},showSpeed:100,callerOnState:"ui-state-active",loadingState:"ui-state-loading",linkHover:"ui-state-hover",linkHoverSecondary:"li-hover",crossSpeed:200,crumbDefaultText:"Choose an option:",backLink:!0,backLinkText:"Back",flyOut:!1,flyOutOnState:"ui-state-default",nextMenuLink:"ui-icon-triangle-1-e",topLinkText:"All",nextCrumbLink:"ui-icon-carat-1-e"},n),r=function(){e.each(u,function(e){u[e].menuOpen&&u[e].kill()})},o=function(){e.each(u,function(e){u[e].kill(),u[e].destroy()}),e(document).unbind("destroyTheFG",o)};this.destroy=function(){s.parent().remove(),i.menuExists=!1},this.kill=function(){t.removeClass(n.loadingState).removeClass("fg-menu-open").removeClass(n.callerOnState),s.find("li").removeClass(n.linkHoverSecondary).find("a").removeClass(n.linkHover),n.flyOutOnState&&s.find("li a").removeClass(n.flyOutOnState),n.callerOnState&&t.removeClass(n.callerOnState),s.is(".fg-menu-ipod")&&i.resetDrilldownMenu(),s.is(".fg-menu-flyout")&&i.resetFlyoutMenu(),s.parent().hide(),i.menuOpen=!1,e(document).unbind("click",r),e(document).unbind("keydown")},this.showLoading=function(){t.addClass(n.loadingState)},this.showMenu=function(){r(),i.menuExists||i.create(),t.addClass("fg-menu-open").addClass(n.callerOnState),s.parent().show().click(function(){return i.kill(),!1}),s.hide().slideDown(n.showSpeed).find(".fg-menu:eq(0)"),i.menuOpen=!0,t.removeClass(n.loadingState),e(document).click(r),e(document).keydown(function(t){var i;""!=t.which?i=t.which:""!=t.charCode?i=t.charCode:""!=t.keyCode&&(i=t.keyCode);var o=e(t.target).parents("div").is(".fg-menu-flyout")?"flyout":"ipod";switch(i){case 37:return"flyout"==o&&(e(t.target).trigger("mouseout"),e("."+n.flyOutOnState).size()>0&&e("."+n.flyOutOnState).trigger("mouseover")),"ipod"==o&&(e(t.target).trigger("mouseout"),e(".fg-menu-footer").find("a").size()>0&&e(".fg-menu-footer").find("a").trigger("click"),e(".fg-menu-header").find("a").size()>0&&e(".fg-menu-current-crumb").prev().find("a").trigger("click"),e(".fg-menu-current").prev().is(".fg-menu-indicator")&&e(".fg-menu-current").prev().trigger("mouseover")),!1;case 38:if(e(t.target).is("."+n.linkHover)){var a=e(t.target).parent().prev().find("a:eq(0)");a.size()>0&&(e(t.target).trigger("mouseout"),a.trigger("mouseover"))}else s.find("a:eq(0)").trigger("mouseover");return!1;case 39:return e(t.target).is(".fg-menu-indicator")&&("flyout"==o?e(t.target).next().find("a:eq(0)").trigger("mouseover"):"ipod"==o&&(e(t.target).trigger("click"),setTimeout(function(){e(t.target).next().find("a:eq(0)").trigger("mouseover")},n.crossSpeed))),!1;case 40:if(e(t.target).is("."+n.linkHover)){var u=e(t.target).parent().next().find("a:eq(0)");u.size()>0&&(e(t.target).trigger("mouseout"),u.trigger("mouseover"))}else s.find("a:eq(0)").trigger("mouseover");return!1;case 27:r();break;case 13:e(t.target).is(".fg-menu-indicator")&&"ipod"==o&&(e(t.target).trigger("click"),setTimeout(function(){e(t.target).next().find("a:eq(0)").trigger("mouseover")},n.crossSpeed))}})},this.create=function(){if(s.css({width:n.width}).appendTo("body").find("ul:first").not(".fg-menu-breadcrumb").addClass("fg-menu"),s.find("ul, li a").addClass("ui-corner-all"),s.find("ul").attr("role","menu").eq(0).attr("aria-activedescendant","active-menuitem").attr("aria-labelledby",t.attr("id")),s.find("li").attr("role","menuitem"),s.find("li:has(ul)").attr("aria-haspopup","true").find("ul").attr("aria-expanded","false"),s.find("a").attr("tabindex","-1"),s.find("ul").size()>1?n.flyOut?i.flyout(s,n):i.drilldown(s,n):s.find("a").click(function(){return i.chooseItem(this),!1}),n.linkHover){var r=s.find(".fg-menu li a");r.hover(function(){e(this);e("."+n.linkHover).removeClass(n.linkHover).blur().parent().removeAttr("id"),e(this).addClass(n.linkHover).focus().parent().attr("id","active-menuitem")},function(){e(this).removeClass(n.linkHover).blur().parent().removeAttr("id")})}n.linkHoverSecondary&&s.find(".fg-menu li").hover(function(){e(this).siblings("li").removeClass(n.linkHoverSecondary),n.flyOutOnState&&e(this).siblings("li").find("a").removeClass(n.flyOutOnState),e(this).addClass(n.linkHoverSecondary)},function(){e(this).removeClass(n.linkHoverSecondary)}),i.setPosition(s,t,n),i.menuExists=!0,e(document).bind("destroyTheFG",o)},this.chooseItem=function(t){var s=e(t).attr("data-value"),r=e(t).parents(".select-box");if("undefined"==typeof s){if(e(t).hasClass("custom"))return location.href=e(t).attr("href");if(r.hasClass("acc"))var o="acc";else var o=null;var a=e(t).parent("li.grouped").next(".sub-group");return a.hasClass("hidden")?("acc"==o&&e(t).parents().find(".sub-group").not(a).slideUp().addClass("hidden"),a.slideDown(n.showSpeed).removeClass("hidden")):a.slideUp(n.showSpeed).addClass("hidden"),!1}i.kill();var u=e("#"+r.attr("data-where").toString()),d=e("#"+r.attr("data-output").toString());return d.val(s),u.text(e(t).text()),r.children().find("a.selected").removeClass("selected"),e(t).addClass("selected"),d.trigger("change"),!1}}function n(){return self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop}function i(){return self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft}function s(){var e=document.documentElement;return self.innerHeight||e&&e.clientHeight||document.body.clientHeight}function r(){var e=document.documentElement;return self.innerWidth||e&&e.clientWidth||document.body.clientWidth}function o(t,n){var s=parseInt(n)||e(t).offset().left;return s+e(t).width()<=r()+i()&&s-i()>=0}function a(t,i){var r=parseInt(i)||e(t).offset().top;return r+e(t).height()<=s()+n()&&r-n()>=0}var u=[];e.fn.ddMenu=function(n){var i=this,n=n,s=new t(i,n);u.push(s),e(this).mousedown(function(){s.menuOpen||s.showLoading()}).click(function(){return 0==s.menuOpen?s.showMenu():s.kill(),!1})},t.prototype.flyout=function(t,n){var i=this;this.resetFlyoutMenu=function(){var e=t.find("ul ul");e.removeClass("ui-widget-content").hide()},t.addClass("fg-menu-flyout").find("li:has(ul)").each(function(){var i,s,r=t.width(),u=e(this).find("ul");u.css({left:r,width:r}).hide(),e(this).find("a:eq(0)").addClass("fg-menu-indicator").html("<span>"+e(this).find("a:eq(0)").text()+'</span><span class="ui-icon '+n.nextMenuLink+'"></span>').hover(function(){clearTimeout(s);var t=e(this).next();a(t,e(this).offset().top)||t.css({top:"auto",bottom:0}),o(t,e(this).offset().left+100)||t.css({left:"auto",right:r,"z-index":999}),i=setTimeout(function(){t.addClass("ui-widget-content").show(n.showSpeed).attr("aria-expanded","true")},300)},function(){clearTimeout(i);var t=e(this).next();s=setTimeout(function(){t.removeClass("ui-widget-content").hide(n.showSpeed).attr("aria-expanded","false")},400)}),e(this).find("ul a").hover(function(){clearTimeout(s),e(this).parents("ul").prev().is("a.fg-menu-indicator")&&e(this).parents("ul").prev().addClass(n.flyOutOnState)},function(){s=setTimeout(function(){u.hide(n.showSpeed),t.find(n.flyOutOnState).removeClass(n.flyOutOnState)},500)})}),t.find("a").click(function(){return i.chooseItem(this),!1})},t.prototype.drilldown=function(t,n){var i=this,s=t.find(".fg-menu"),r=e('<ul class="fg-menu-breadcrumb ui-widget-header ui-corner-all ui-helper-clearfix"></ul>'),o=e('<li class="fg-menu-breadcrumb-text">'+n.crumbDefaultText+"</li>"),a=n.backLink?n.backLinkText:n.topLinkText,u=n.backLink?"fg-menu-prev-list":"fg-menu-all-lists",d=n.backLink?"ui-state-default ui-corner-all":"",c=n.backLink?'<span class="ui-icon ui-icon-triangle-1-w"></span>':"",l=e('<li class="'+u+'"><a href="#" class="'+d+'">'+c+a+"</a></li>");t.addClass("fg-menu-ipod"),n.backLink?r.addClass("fg-menu-footer").appendTo(t).hide():r.addClass("fg-menu-header").prependTo(t),r.append(o);var f=function(e){e.height()>n.maxHeight&&e.addClass("fg-menu-scroll"),e.css({height:n.maxHeight})},h=function(e){e.removeClass("fg-menu-scroll").removeClass("fg-menu-current").height("auto")};this.resetDrilldownMenu=function(){e(".fg-menu-current").removeClass("fg-menu-current"),s.animate({left:0},n.crossSpeed,function(){e(this).find("ul").each(function(){e(this).hide(),h(e(this))}),s.addClass("fg-menu-current")}),e(".fg-menu-all-lists").find("span").remove(),r.empty().append(o),e(".fg-menu-footer").empty().hide(),f(s)},s.addClass("fg-menu-content fg-menu-current ui-widget-content ui-helper-clearfix").css({width:t.width()}).find("ul").css({width:t.width(),left:t.width()}).addClass("ui-widget-content").hide(),f(s),s.find("a").each(function(){e(this).next().is("ul")?e(this).addClass("fg-menu-indicator").each(function(){e(this).html("<span>"+e(this).text()+'</span><span class="ui-icon '+n.nextMenuLink+'"></span>')}).click(function(){var o=e(this).next(),a=e(this).parents("ul:eq(0)"),u=a.is(".fg-menu-content")?0:parseFloat(s.css("left")),d=Math.round(u-parseFloat(t.width())),c=e(".fg-menu-footer");h(a),f(o),s.animate({left:d},n.crossSpeed),o.show().addClass("fg-menu-current").attr("aria-expanded","true");var p=function(t){var n=t,i=e(".fg-menu-current"),s=i.parents("ul:eq(0)");i.hide().attr("aria-expanded","false"),h(i),f(s),s.addClass("fg-menu-current").attr("aria-expanded","true"),s.hasClass("fg-menu-content")&&(n.remove(),c.hide())};if(n.backLink)0==c.find("a").size()&&(c.show(),e('<a href="#"><span class="ui-icon ui-icon-triangle-1-w"></span> <span>Back</span></a>').appendTo(c).click(function(){var i=e(this),r=parseFloat(s.css("left"))+t.width();return s.animate({left:r},n.crossSpeed,function(){p(i)}),!1}));else{1==r.find("li").size()&&(r.empty().append(l),l.find("a").click(function(){return i.resetDrilldownMenu(),!1})),e(".fg-menu-current-crumb").removeClass("fg-menu-current-crumb");var m=e(this).find("span:eq(0)").text(),g=e('<li class="fg-menu-current-crumb"><a href="javascript://" class="fg-menu-crumb">'+m+"</a></li>");g.appendTo(r).find("a").click(function(){if(e(this).parent().is(".fg-menu-current-crumb"))i.chooseItem(this);else{var t=180*-(e(".fg-menu-current").parents("ul").size()-1);s.animate({left:t},n.crossSpeed,function(){p()}),e(this).parent().addClass("fg-menu-current-crumb").find("span").remove(),e(this).parent().nextAll().remove()}return!1}),g.prev().append(' <span class="ui-icon '+n.nextCrumbLink+'"></span>')}return!1}):e(this).click(function(){return i.chooseItem(this),!1})})},t.prototype.setPosition=function(t,n,i){var s,r,u=t,d=n,c={refX:d.offset().left,refY:d.offset().top,refW:d.getTotalWidth(),refH:d.getTotalHeight()},i=i,l=e('<div class="positionHelper"></div>');switch(l.css({position:"absolute",left:c.refX,top:c.refY,width:c.refW,height:c.refH}),u.wrap(l),i.positionOpts.posX){case"left":s=0;break;case"center":s=c.refW/2;break;case"right":s=c.refW}switch(i.positionOpts.posY){case"top":r=0;break;case"center":r=c.refH/2;break;case"bottom":r=c.refH}s+=i.positionOpts.offsetX,r+=i.positionOpts.offsetY,"up"==i.positionOpts.directionV?(u.css({top:"auto",bottom:r}),i.positionOpts.detectV&&!a(u)&&u.css({bottom:"auto",top:r})):(u.css({bottom:"auto",top:r}),i.positionOpts.detectV&&!a(u)&&u.css({top:"auto",bottom:r})),"left"==i.positionOpts.directionH?(u.css({left:"auto",right:s}),i.positionOpts.detectH&&!o(u)&&u.css({right:"auto",left:s})):(u.css({right:"auto",left:s}),i.positionOpts.detectH&&!o(u)&&u.css({left:"auto",right:s})),i.positionOpts.linkToFront&&d.clone().addClass("linkClone").css({position:"absolute",top:0,right:"auto",bottom:"auto",left:0,width:d.width(),height:d.height()}).insertAfter(u)},jQuery.fn.getTotalWidth=function(){return e(this).width()+parseInt(e(this).css("paddingRight"))+parseInt(e(this).css("paddingLeft"))+parseInt(e(this).css("borderRightWidth"))+parseInt(e(this).css("borderLeftWidth"))},jQuery.fn.getTotalHeight=function(){return e(this).height()+parseInt(e(this).css("paddingTop"))+parseInt(e(this).css("paddingBottom"))+parseInt(e(this).css("borderTopWidth"))+parseInt(e(this).css("borderBottomWidth"))},Number.prototype.pxToEm=String.prototype.pxToEm=function(t){t=jQuery.extend({scope:"body",reverse:!1},t);var n,i=""==this?0:parseFloat(this),s=function(){var e=document.documentElement;return self.innerWidth||e&&e.clientWidth||document.body.clientWidth};if("body"==t.scope&&e.browser.msie&&(parseFloat(e("body").css("font-size"))/s()).toFixed(1)>0){var r=function(){return 16*(parseFloat(e("body").css("font-size"))/s()).toFixed(3)};n=r()}else n=parseFloat(jQuery(t.scope).css("font-size"));var o=1==t.reverse?(i*n).toFixed(2)+"px":(i/n).toFixed(2)+"em";return o}}(jQuery);